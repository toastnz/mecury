// ======================================
// function to return parent class ======
// ======================================

@function simple-selector-scope {
	$classlist: "#{&}";
    $split-arr: ();
    $index : str-index($classlist, " ");

    // loop through string
    @while $index != null {
        $item: str-slice($classlist, 1, $index - 1);
        $split-arr: append($split-arr, $item);
        $classlist: str-slice($classlist, $index + 1);
        $index : str-index($classlist, " ");
    }

    $split-arr: append($split-arr, $classlist);
    @return nth($classlist, length($classlist));
}

// ======================================
// Styles ===============================
// ======================================

@mixin simple-selector (
	$min-width: 32rem,
	$border-radius: 0,
	$border-width: .1rem,

	$header-color: $black,
	$header-border-color: rgba($black, .2),
	$header-background-color: $white,
	$header-padding: 1rem 4rem 1rem 2rem,

	$chevron-color: $black,

	$list-border-color: rgba($black, .2),
	$list-background-color: $white,
	$list-padding: 0,

	$search-color: $black,
	$search-border-color: rgba($black, .2),
	$search-background-color: $white,

	$option-color: $black,
	$option-background-color: $white,
	$option-transition-speed: 0.3s,

	$option-color--hover: $black,
	$option-background-color--hover: rgba($black, .1),

	$option-color--active: $white,
	$option-background-color--active: rgba($black, .6),
) {
	$parent: simple-selector-scope();
	position: relative;
	z-index: 100;
	display: block;
	float: left;
  min-width: $min-width;
	transition: z-index .3s ease;

	+ select {
		display: none;
	}

	&.js-active {
		z-index: 150;

		#{$parent} {
			&__header {
				border-radius: $border-radius $border-radius 0 0;
				&:before {
					transform: translate(50%, -30%) rotate(45deg) scale(-1);
				}
			}

			&__list {
				color: $option-color;
				transform: scaleY(1);
				border-radius: 0 0 $border-radius $border-radius;
			}
		}
	}

	&.multiple {
		#{$parent}__option {
			position: relative;
			padding-right: 4rem!important;

			&:before,
			&:after {
				content: '';
				position: absolute;
				top: 50%;
				right: 2rem;
				height: 1.4rem;
				width: 1.4rem;
				border-radius: 50%;
				opacity: .8;
			}

			&:before {
				border: $border-width solid $option-color;
				transition: border-color .2s ease;
				transform: translate(50%,-50%);
			}

			&:after {
				background-color: transparent;
				transition: background-color .2s ease;
				transform: translate(50%,-50%) scale(0.5);
			}

			&--active {
				&:before {
					border-color: $option-color--active;
				}

				&:after {
					background-color: $option-color--active;
				}
			}
		}
	}

	&__header {
		position: relative;
		width: 100%;
		padding: $header-padding;
		border: $border-width solid $header-border-color;
		cursor: pointer;
		background-color: $header-background-color;
		border-radius: $border-radius;
		transition: border-radius .3s ease;

		&:before {
			content: '';
			position: absolute;
			top: 50%;
			right: 2rem;
			height: 1rem;
			width: 1rem;
			border-right: .2rem solid $chevron-color;
			border-bottom: .2rem solid $chevron-color;
			transform: translate(50%, -60%) rotate(45deg) scale(1);
			transition: transform .3s ease;
		}
	}

	&__placeholder {
		color: $header-color;
		user-select: none;
	}

	&__search {
		margin-bottom: 0!important;
	}

	&__searchInput {
		margin-bottom: 0;
		border: 0;
		width: 100%;
		padding: 1rem 2rem!important;
		color: $search-color;
		border-color: $search-border-color;
		background-color: $search-background-color;
	}

	&__list {
		display: block;
		position: absolute;
		top: 100%;
		left: 0;
		width: 100%;
		padding: $list-padding!important;
		margin: 0;
		color: transparent;
		background-color: $list-background-color;
		border: $border-width solid $list-border-color;
		border-top: none;
		transform: scaleY(0);
		transform-origin: 50% 0;
		transition: transform .2s ease;
		max-height: 40rem;
		overflow: auto;
	}

	&__option {
		user-select: none;
		cursor: pointer;
		padding: 1rem 2rem!important;
		margin-bottom: 0!important;
		color: inherit;
		background-color: $option-background-color;
		transition: background-color $option-transition-speed ease, color $option-transition-speed ease;

		&:hover {
			color: $option-color--hover;
			background-color: $option-background-color--hover;
		}

		&--active {
			&,
			&:hover {
				color: $option-color--active;
				background-color: $option-background-color--active;
			}
		}
	}
}
